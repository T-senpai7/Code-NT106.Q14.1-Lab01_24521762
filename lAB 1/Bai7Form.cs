using System;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;
// C√≥ s·ª≠ d·ª•ng AI adding icon ƒë·ªÉ ph√¢n tier cho hsinh 
namespace WindowsFormsApp
{
    public class Bai7Form : Form
    {
        private Panel panelHeader;
        private Label lblTitle;
        private Label lblSubtitle;
        private Panel panelInput;
        private Label lblInputLabel;
        private Label lblName;
        private TextBox txtName;
        private Label lblToan;
        private TextBox txtToan;
        private Label lblVan;
        private TextBox txtVan;
        private Label lblAnh;
        private TextBox txtAnh;
        private Button btnProcess;
        private Button btnClear;
        private Panel panelOutput;
        private Label lblOutputLabel;
        private RichTextBox txtOutput;

        public Bai7Form()
        {
            InitializeComponent();
        }

        private void InitializeComponent()
        {
            Text = "X·ª≠ l√Ω ƒëi·ªÉm sinh vi√™n";
            StartPosition = FormStartPosition.CenterParent;
            Size = new Size(900, 700);
            BackColor = Color.FromArgb(240, 242, 245);
            Padding = new Padding(15);

            panelHeader = new Panel
            {
                Location = new Point(15, 15),
                Size = new Size(850, 80),
                BackColor = Color.FromArgb(0, 120, 215)
            };

            lblTitle = new Label
            {
                Text = "üìä X·ª¨ L√ù ƒêI·ªÇM SINH VI√äN",
                Location = new Point(20, 15),
                Size = new Size(810, 35),
                Font = new Font("Segoe UI", 18, FontStyle.Bold),
                ForeColor = Color.White,
                TextAlign = ContentAlignment.MiddleCenter
            };

            lblSubtitle = new Label
            {
                Text = "Nh·∫≠p ƒëi·ªÉm 3 m√¥n: To√°n - VƒÉn - Anh",
                Location = new Point(20, 50),
                Size = new Size(810, 20),
                Font = new Font("Segoe UI", 10, FontStyle.Regular),
                ForeColor = Color.FromArgb(230, 240, 255),
                TextAlign = ContentAlignment.MiddleCenter
            };

            panelHeader.Controls.Add(lblTitle);
            panelHeader.Controls.Add(lblSubtitle);

            panelInput = new Panel
            {
                Location = new Point(15, 105),
                Size = new Size(850, 240),
                BackColor = Color.White,
                BorderStyle = BorderStyle.FixedSingle
            };

            lblInputLabel = new Label
            {
                Text = "Nh·∫≠p th√¥ng tin:",
                Location = new Point(15, 15),
                Size = new Size(820, 25),
                Font = new Font("Segoe UI", 11, FontStyle.Bold),
                ForeColor = Color.FromArgb(50, 50, 50)
            };

            lblName = new Label
            {
                Text = "üë§ H·ªç v√† t√™n:",
                Location = new Point(30, 55),
                Size = new Size(120, 25),
                Font = new Font("Segoe UI", 10, FontStyle.Regular),
                ForeColor = Color.FromArgb(70, 70, 70),
                TextAlign = ContentAlignment.MiddleLeft
            };

            txtName = new TextBox
            {
                Location = new Point(160, 53),
                Size = new Size(660, 30),
                Font = new Font("Segoe UI", 11),
                BorderStyle = BorderStyle.FixedSingle,
                BackColor = Color.FromArgb(250, 250, 250)
            };

            lblToan = new Label
            {
                Text = "üìê ƒêi·ªÉm To√°n:",
                Location = new Point(30, 100),
                Size = new Size(120, 25),
                Font = new Font("Segoe UI", 10, FontStyle.Regular),
                ForeColor = Color.FromArgb(70, 70, 70),
                TextAlign = ContentAlignment.MiddleLeft
            };

            txtToan = new TextBox
            {
                Location = new Point(160, 98),
                Size = new Size(200, 30),
                Font = new Font("Segoe UI", 11),
                BorderStyle = BorderStyle.FixedSingle,
                BackColor = Color.FromArgb(250, 250, 250)
            };

            lblVan = new Label
            {
                Text = "üìñ ƒêi·ªÉm VƒÉn:",
                Location = new Point(30, 145),
                Size = new Size(120, 25),
                Font = new Font("Segoe UI", 10, FontStyle.Regular),
                ForeColor = Color.FromArgb(70, 70, 70),
                TextAlign = ContentAlignment.MiddleLeft
            };

            txtVan = new TextBox
            {
                Location = new Point(160, 143),
                Size = new Size(200, 30),
                Font = new Font("Segoe UI", 11),
                BorderStyle = BorderStyle.FixedSingle,
                BackColor = Color.FromArgb(250, 250, 250)
            };

            lblAnh = new Label
            {
                Text = "üåê ƒêi·ªÉm Anh:",
                Location = new Point(30, 190),
                Size = new Size(120, 25),
                Font = new Font("Segoe UI", 10, FontStyle.Regular),
                ForeColor = Color.FromArgb(70, 70, 70),
                TextAlign = ContentAlignment.MiddleLeft
            };

            txtAnh = new TextBox
            {
                Location = new Point(160, 188),
                Size = new Size(200, 30),
                Font = new Font("Segoe UI", 11),
                BorderStyle = BorderStyle.FixedSingle,
                BackColor = Color.FromArgb(250, 250, 250)
            };

            btnProcess = new Button
            {
                Text = "X·ª≠ l√Ω d·ªØ li·ªáu",
                Location = new Point(400, 98),
                Size = new Size(150, 45),
                Font = new Font("Segoe UI", 10, FontStyle.Bold),
                BackColor = Color.FromArgb(0, 120, 215),
                ForeColor = Color.White,
                FlatStyle = FlatStyle.Flat,
                Cursor = Cursors.Hand
            };
            btnProcess.FlatAppearance.BorderSize = 0;
            btnProcess.Click += BtnProcess_Click;

            btnClear = new Button
            {
                Text = "X√≥a",
                Location = new Point(400, 158),
                Size = new Size(150, 45),
                Font = new Font("Segoe UI", 10, FontStyle.Bold),
                BackColor = Color.FromArgb(220, 220, 220),
                ForeColor = Color.FromArgb(60, 60, 60),
                FlatStyle = FlatStyle.Flat,
                Cursor = Cursors.Hand
            };
            btnClear.FlatAppearance.BorderSize = 0;
            btnClear.Click += BtnClear_Click;

            panelInput.Controls.Add(lblInputLabel);
            panelInput.Controls.Add(lblName);
            panelInput.Controls.Add(txtName);
            panelInput.Controls.Add(lblToan);
            panelInput.Controls.Add(txtToan);
            panelInput.Controls.Add(lblVan);
            panelInput.Controls.Add(txtVan);
            panelInput.Controls.Add(lblAnh);
            panelInput.Controls.Add(txtAnh);
            panelInput.Controls.Add(btnProcess);
            panelInput.Controls.Add(btnClear);

            panelOutput = new Panel
            {
                Location = new Point(15, 355),
                Size = new Size(850, 310),
                BackColor = Color.White,
                BorderStyle = BorderStyle.FixedSingle
            };

            lblOutputLabel = new Label
            {
                Text = "üìã K·∫øt qu·∫£ ph√¢n t√≠ch:",
                Location = new Point(15, 10),
                Size = new Size(820, 25),
                Font = new Font("Segoe UI", 11, FontStyle.Bold),
                ForeColor = Color.FromArgb(50, 50, 50)
            };

            txtOutput = new RichTextBox
            {
                Location = new Point(15, 40),
                Size = new Size(820, 255),
                Font = new Font("Consolas", 10),
                ReadOnly = true,
                BackColor = Color.FromArgb(250, 250, 250),
                BorderStyle = BorderStyle.None,
                ScrollBars = RichTextBoxScrollBars.Vertical
            };

            panelOutput.Controls.Add(lblOutputLabel);
            panelOutput.Controls.Add(txtOutput);

            Controls.Add(panelHeader);
            Controls.Add(panelInput);
            Controls.Add(panelOutput);

            txtOutput.Text = "Ch√†o m·ª´ng! Vui l√≤ng nh·∫≠p th√¥ng tin sinh vi√™n v√† ƒëi·ªÉm 3 m√¥n.";
            txtOutput.SelectionFont = new Font("Segoe UI", 10, FontStyle.Italic);
            txtOutput.SelectionColor = Color.Gray;
        }

        private void BtnClear_Click(object sender, EventArgs e)
        {
            txtName.Clear();
            txtToan.Clear();
            txtVan.Clear();
            txtAnh.Clear();
            txtOutput.Clear();
            txtOutput.Text = "Ch√†o m·ª´ng! Vui l√≤ng nh·∫≠p th√¥ng tin sinh vi√™n v√† ƒëi·ªÉm 3 m√¥n.";
            txtOutput.SelectionFont = new Font("Segoe UI", 10, FontStyle.Italic);
            txtOutput.SelectionColor = Color.Gray;
            txtName.Focus();
        }

        private void BtnProcess_Click(object sender, EventArgs e)
        {
            txtOutput.Clear();

            string studentName = txtName.Text.Trim();
            if (string.IsNullOrWhiteSpace(studentName))
            {
                ShowError("‚ö†Ô∏è Vui l√≤ng nh·∫≠p h·ªç v√† t√™n sinh vi√™n!");
                return;
            }

            if (string.IsNullOrWhiteSpace(txtToan.Text))
            {
                ShowError("‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒëi·ªÉm To√°n!");
                return;
            }
            if (!double.TryParse(txtToan.Text.Trim(), out double diemToan))
            {
                ShowError($"‚ùå ƒêi·ªÉm To√°n '{txtToan.Text}' kh√¥ng h·ª£p l·ªá!");
                return;
            }
            if (diemToan < 0 || diemToan > 10)
            {
                ShowError($"‚ùå ƒêi·ªÉm To√°n ph·∫£i t·ª´ 0-10 (nh·∫≠p: {diemToan})");
                return;
            }

            if (string.IsNullOrWhiteSpace(txtVan.Text))
            {
                ShowError("‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒëi·ªÉm VƒÉn!");
                return;
            }
            if (!double.TryParse(txtVan.Text.Trim(), out double diemVan))
            {
                ShowError($"‚ùå ƒêi·ªÉm VƒÉn '{txtVan.Text}' kh√¥ng h·ª£p l·ªá!");
                return;
            }
            if (diemVan < 0 || diemVan > 10)
            {
                ShowError($"‚ùå ƒêi·ªÉm VƒÉn ph·∫£i t·ª´ 0-10 (nh·∫≠p: {diemVan})");
                return;
            }

            if (string.IsNullOrWhiteSpace(txtAnh.Text))
            {
                ShowError("‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒëi·ªÉm Anh!");
                return;
            }
            if (!double.TryParse(txtAnh.Text.Trim(), out double diemAnh))
            {
                ShowError($"‚ùå ƒêi·ªÉm Anh '{txtAnh.Text}' kh√¥ng h·ª£p l·ªá!");
                return;
            }
            if (diemAnh < 0 || diemAnh > 10)
            {
                ShowError($"‚ùå ƒêi·ªÉm Anh ph·∫£i t·ª´ 0-10 (nh·∫≠p: {diemAnh})");
                return;
            }

            ShowSuccess("‚úÖ ƒê√£ nh·∫≠p ƒë√∫ng th√¥ng tin!\n\n");
            double[] grades = { diemToan, diemVan, diemAnh };
            string[] subjects = { "To√°n", "VƒÉn", "Anh" };
            ProcessAndDisplayResults(studentName, grades, subjects);
        }
// layout th√¥ng tin sinh vi√™n output - AI c·∫•u h√¨nh l·∫°i design 
        private void ProcessAndDisplayResults(string studentName, double[] grades, string[] subjects)
        {
            AppendText("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n");
            
            AppendColoredText("üë§ H·ªç v√† t√™n: ", Color.FromArgb(80, 80, 80), true);
            AppendColoredText($"{studentName}\n", Color.FromArgb(0, 120, 215), true);
            AppendText("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n");

            AppendColoredText("üìö B·∫¢NG ƒêI·ªÇM:\n", Color.FromArgb(0, 150, 136), true);
            AppendText("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n");
            
            for (int i = 0; i < grades.Length; i++)
            {
                Color gradeColor = GetGradeColor(grades[i]);
                AppendColoredText($"   {subjects[i],-8}: ", Color.FromArgb(100, 100, 100), false);
                AppendColoredText($"{grades[i],5:F1}", gradeColor, true);
                
                if (grades[i] >= 8)
                    AppendColoredText(" ‚≠ê Gi·ªèi", Color.Gold, false);
                else if (grades[i] >= 6.5)
                    AppendColoredText(" ‚úì Kh√°", Color.Green, false);
                else if (grades[i] >= 5)
                    AppendColoredText(" ‚úì Trung b√¨nh", Color.Orange, false);
                else
                    AppendColoredText(" ‚úó Y·∫øu", Color.Red, false);
                
                AppendText("\n");
            }
            AppendText("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n");

            double average = grades.Average();
            AppendColoredText("üìä TH·ªêNG K√ä:\n", Color.FromArgb(156, 39, 176), true);
            AppendText("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n");
            AppendColoredText("   ƒêi·ªÉm trung b√¨nh: ", Color.FromArgb(100, 100, 100), false);
            AppendColoredText($"{average:F2}\n", Color.FromArgb(33, 150, 243), true);

            double maxGrade = grades.Max();
            double minGrade = grades.Min();
            
            int maxIndex = Array.IndexOf(grades, maxGrade);
            int minIndex = Array.IndexOf(grades, minGrade);

            AppendColoredText("   M√¥n ƒëi·ªÉm cao nh·∫•t: ", Color.FromArgb(100, 100, 100), false);
            AppendColoredText($"{subjects[maxIndex]} - ", Color.Black, false);
            AppendColoredText($"{maxGrade:F1} ‚¨Ü\n", Color.FromArgb(76, 175, 80), true);
            
            AppendColoredText("   M√¥n ƒëi·ªÉm th·∫•p nh·∫•t: ", Color.FromArgb(100, 100, 100), false);
            AppendColoredText($"{subjects[minIndex]} - ", Color.Black, false);
            AppendColoredText($"{minGrade:F1} ‚¨á\n", Color.FromArgb(244, 67, 54), true);

            int passCount = grades.Count(g => g >= 5);
            int failCount = grades.Count(g => g < 5);

            AppendColoredText("   S·ªë m√¥n ƒë·∫≠u: ", Color.FromArgb(100, 100, 100), false);
            AppendColoredText($"{passCount}/3", Color.FromArgb(76, 175, 80), true);
            AppendText($" ({(double)passCount / 3 * 100:F0}%)\n");
            
            AppendColoredText("   S·ªë m√¥n kh√¥ng ƒë·∫≠u: ", Color.FromArgb(100, 100, 100), false);
            AppendColoredText($"{failCount}/3", Color.FromArgb(244, 67, 54), true);
            AppendText($" ({(double)failCount / 3 * 100:F0}%)\n");
            
            AppendText("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n");

            string classification = ClassifyStudent(average, grades);
            string icon = GetClassificationIcon(classification);
            Color classColor = GetClassificationColor(classification);
            
            AppendColoredText("üèÜ X·∫æP LO·∫†I: ", Color.FromArgb(255, 152, 0), true);
            AppendColoredText($"{icon} {classification}\n", classColor, true);
            AppendText("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n");
        }

        private Color GetGradeColor(double grade)
        {
            if (grade >= 8.5) return Color.FromArgb(0, 200, 83);
            if (grade >= 7) return Color.FromArgb(76, 175, 80);
            if (grade >= 5.5) return Color.FromArgb(255, 152, 0);
            if (grade >= 4) return Color.FromArgb(255, 87, 34);
            return Color.FromArgb(244, 67, 54);
        }

        private string ClassifyStudent(double average, double[] grades)
        {
            double minGrade = grades.Min();

            if (average >= 8 && minGrade >= 6.5)
                return "GI·ªéI";
            else if (average >= 6.5 && minGrade >= 5)
                return "KH√Å";
            else if (average >= 5 && minGrade >= 3.5)
                return "TRUNG B√åNH";
            else if (average >= 3.5 && minGrade >= 2)
                return "Y·∫æU";
            else
                return "K√âM";
        }

        private string GetClassificationIcon(string classification)
        {
            switch (classification)
            {
                case "GI·ªéI": return "ü•á";
                case "KH√Å": return "ü•à";
                case "TRUNG B√åNH": return "ü•â";
                case "Y·∫æU": return "‚ö†Ô∏è";
                case "K√âM": return "‚ùå";
                default: return "";
            }
        }

        private Color GetClassificationColor(string classification)
        {
            switch (classification)
            {
                case "GI·ªéI": return Color.FromArgb(0, 200, 83);
                case "KH√Å": return Color.FromArgb(33, 150, 243);
                case "TRUNG B√åNH": return Color.FromArgb(255, 152, 0);
                case "Y·∫æU": return Color.FromArgb(255, 87, 34);
                case "K√âM": return Color.FromArgb(244, 67, 54);
                default: return Color.Black;
            }
        }

        private void ShowError(string message)
        {
            txtOutput.Clear();
            AppendColoredText(message + "\n\n", Color.FromArgb(244, 67, 54), true);
            AppendColoredText("üí° L∆∞u √Ω:\n", Color.FromArgb(255, 152, 0), true);
            AppendText("‚Ä¢ Nh·∫≠p ƒë·∫ßy ƒë·ªß h·ªç t√™n v√† ƒëi·ªÉm 3 m√¥n\n");
            AppendText("‚Ä¢ ƒêi·ªÉm ph·∫£i l√† s·ªë t·ª´ 0 ƒë·∫øn 10\n");
            AppendText("‚Ä¢ C√≥ th·ªÉ nh·∫≠p s·ªë th·∫≠p ph√¢n (VD: 8.5)\n");
        }

        private void ShowSuccess(string message)
        {
            AppendColoredText(message, Color.FromArgb(76, 175, 80), true);
        }

        private void AppendText(string text)
        {
            txtOutput.SelectionFont = new Font("Consolas", 10);
            txtOutput.SelectionColor = Color.FromArgb(60, 60, 60);
            txtOutput.AppendText(text);
        }

        private void AppendColoredText(string text, Color color, bool bold = false)
        {
            txtOutput.SelectionStart = txtOutput.TextLength;
            txtOutput.SelectionLength = 0;
            txtOutput.SelectionColor = color;
            txtOutput.SelectionFont = new Font("Consolas", 10, bold ? FontStyle.Bold : FontStyle.Regular);
            txtOutput.AppendText(text);
        }
    }
}